{% extends "layout.html" %}

{% block dynamicpage %}
<div class="doc-body">
    <div class="doc-container">
        <div class="doc-header">
            <h1 class="doc-title"><i class="fas fa-folder-open"></i> My Documents</h1>
            <a  href="{% url 'document-upload' %}"><button class="doc-upload-btn">
                <i class="fas fa-plus"></i> Upload Document
            </button></a>
        </div>

        <div class="doc-categories">
            <div class="doc-category active">All Documents</div>
            <div class="doc-category">Resumes</div>
            <div class="doc-category">Cover Letters</div>
            <div class="doc-category">Certificates</div>
            <!-- <div class="doc-category">Pdfs</div>
            <div class="doc-category">Text Files</div> -->
        </div>

        <div class="doc-grid">
            <!-- Document Card 1 -->
            {% if has_documents %}
                {% for document in user_documents %}
                <div class="doc-card" data-id="{{ document.pk }}">
                    <div class="doc-icon">
                        {% if document.file_format == 'txt' %}
                        <i class="fas fa-file-alt"></i>
                        {% else %}
                        <i class="fas fa-file-pdf"></i>
                        {% endif %}
                    </div>
                    <h3 class="doc-name {{ document.file_type }}" data-type="{{ document.file_type }}" data-id="{{ document.pk }}">{{ document.name }}</h3>
                    <div class="doc-meta">
                        <div>{{ document.created_at }}</div>
                        <div>Size: {{ document.size }} MB</div>
                    </div>
                    <div class="doc-actions">
                        {% if document.file_format == 'doc' or document.file_format == 'docx' %}
                        <button class="doc-action-btn doc-view" title="{{document.file_format|title}} view not supported">
                            <i class="fas fa-eye-slash"></i>
                        </button>
                        {% else %}
                        <a href="{% url 'view_resume' pk=document.pk %}" class="applicantinfo-document-link"><button class="doc-action-btn doc-view" title="View">
                            <i class="fas fa-eye"></i>
                        </button></a>
                        {% endif %}
                        <a href="{{document.download_url}}" download="{{ document.name }}.{{ document.file_format }}"><button class="doc-action-btn doc-download" title="Download">
                            <i class="fas fa-download"></i></a>
                        </button>
                        <button class="doc-action-btn doc-delete" onclick="showDeleteDialog('{{ document.name }}','{{ document.id }}')" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <!-- Empty State (hidden by default) -->
                <div class="doc-empty-state">
                    <div class="doc-empty-icon">
                        <i class="fas fa-folder-open"></i>
                    </div>
                    <h3>No Documents Found</h3>
                    <p class="doc-empty-text">Upload your first document to get started with your job applications</p>
                    <a  href="{% url 'document-upload' %}"><button class="doc-upload-btn">
                        <i class="fas fa-plus"></i> Upload Document
                    </button></a>
                </div>
            {% endif %}

        </div>
    </div>
</div>
    <!-- Can be placed anywhere in your HTML -->
    <div class="dialog-overlay" id="deleteDialog">
        <div class="dialog-container">
            <div class="dialog-icon">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>
            </div>
            <h3 class="dialog-title">Delete Document?</h3>
            <p class="dialog-message" id="dialogMessage">
                <!-- Message will be inserted via JavaScript -->
            </p>
            <div class="dialog-actions">
                <button class="btn btn-secondary" id="cancelBtn">Cancel</button>
                <button class="btn btn-danger" id="confirmBtn">Delete</button>
            </div>
        </div>
    </div>



<script>
    $(document).ready(function() {
        const msg = document.querySelectorAll(".msg-auth");
        msg.forEach(function (message) {
            const messageText = message.getAttribute("data-id");
            toastr.success(messageText, "Success", {
                closeButton: true,
                progressBar: true,
                positionClass: "toast-top-right",
                timeOut: 3000
            });
        });
    });
</script>

{% if messages %}
    {% for message in messages %}
        <div class="msg-auth" data-id="{{ message }}"></div>
    {% endfor %}
{% endif %}

{% endblock dynamicpage %}
